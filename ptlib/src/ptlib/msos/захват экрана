HDC h_scrdc = GetDC(0);
HDC h_dc = CreateCompatibleDC(h_scrdc);
long l_scrWidth = GetDeviceCaps(h_scrdc, HORZRES);
long l_scrHeight = GetDeviceCaps(h_scrdc, VERTRES);
HBITMAP h_bmp = CreateCompatibleBitmap(h_scrdc, l_scrWidth, l_scrHeight);
HBITMAP h_bmpOld = (HBITMAP)SelectObject(h_dc, h_bmp);

BOOL b_ret = BitBlt(h_dc, 0, 0, l_ scrWidth, l_ scrHeight, h_scrdc, 0, 0, SRCCOPY);

HPALETTE h_Palette = SelectPalette(h_dc, NULL, FALSE);
SaveBitmap(h_bmp, h_Palette, "C:\\screenshot.bmp");

SelectObject(h_dc, h_bmpOld);
DeleteObject(h_bmp);
DeleteDC(h_dc);
ReleaseDC(0, h_scrdc);


GetDC(HWND_DESKTOP) - девайс экрана 

 //for example
     hDc = GetDC(hWndScr);
     hMemDc = CreateCompatibleDC(hDc);
     hBmpNew = CreateCompatibleBitmap(hDc, 500, 500);
     hBmpOld = SelectObject(hMemDc, hBmpNew);
     BitBlt(hMemDc, 0, 0, 500, 500, hDc, 0, 0, SRCCOPY);
